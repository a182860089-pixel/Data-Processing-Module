# 视频转换功能前端集成指南

## 概览

已成功将视频转换功能集成到现有的Vue 3前端项目中。现在你可以通过Web界面来测试视频→Markdown/PDF的转换功能。

## 集成内容

### 新增组件

1. **VideoUploader.vue** (`src/components/VideoUploader.vue`)
   - 视频上传界面
   - 支持拖放上传
   - 实时转换选项配置
   - 转换进度显示
   - 结果下载

### 修改文件

1. **App.vue** 
   - 添加了视频转换标签页
   - 导入VideoUploader组件
   - 更新了footer信息

## 快速开始

### 1. 启动后端API服务

```bash
cd D:\Data Processing Module\data_to_md-main
python -m uvicorn app.main:app --reload --port 8000
```

### 2. 启动前端开发服务器

```bash
cd D:\Data Processing Module\proc_image\smallimg
npm run dev
```

### 3. 访问页面

打开浏览器访问：`http://localhost:5173`

### 4. 使用视频转换功能

1. 点击导航栏中的 **🎬 视频 → MD/PDF** 标签
2. 上传视频文件（支持拖放）
3. 配置转换选项：
   - **输出格式**：Markdown 或 PDF
   - **关键帧间隔**：每隔多少秒提取一帧（1-30秒）
   - **最大帧数**：最多提取多少帧（5-200帧）
   - **帧质量**：JPEG质量（50-100%）
   - **包含选项**：元数据和关键帧
4. 点击 **开始转换** 按钮
5. 等待转换完成后下载结果

## 功能详情

### 视频上传区域

- 支持拖放上传
- 支持批量上传（最多5个视频）
- 文件类型检查（MP4, AVI, MOV, WMV, MKV, FLV）
- 文件大小限制（最大500MB）

### 转换选项

| 选项 | 范围 | 默认值 | 说明 |
|------|------|--------|------|
| 输出格式 | markdown / pdf | markdown | 选择输出为Markdown还是PDF |
| 关键帧间隔 | 1-30秒 | 5秒 | 每隔指定秒数提取一帧 |
| 最大帧数 | 5-200 | 50 | 限制提取的帧数 |
| 帧质量 | 50-100% | 85% | JPEG压缩质量 |
| 包含元数据 | 开/关 | 开 | 包含视频元信息 |
| 包含关键帧 | 开/关 | 开 | 包含提取的帧图像 |

### 转换进度

- 实时显示进度条
- 显示当前状态（等待中/转换中/已完成/失败）
- 显示文件大小和进度百分比

### 结果显示

**Markdown输出：**
- 一键下载Markdown文件
- 包含：
  - 视频元数据表格（时长、FPS、分辨率等）
  - 关键帧图像（Base64嵌入）
  - 时间戳信息

**PDF输出：**
- 一键下载PDF文件
- 包含：
  - 专业格式的元数据表格
  - 分页显示的关键帧
  - 美化的样式和排版

### 元数据查看

- 点击"查看元数据"可展开详细信息
- 显示：
  - 视频时长、FPS、总帧数
  - 分辨率、文件大小
  - 编码格式
  - 提取的帧数

## 配置API地址

如果后端API不是默认的 `http://localhost:8000`，可以在转换选项面板中修改API地址：

```
API 地址: http://your-server:port/api/v1
```

## 常见问题

### Q: 前端无法连接到后端？
A: 
1. 确保后端API服务已启动（`python -m uvicorn app.main:app --reload`）
2. 检查API地址是否正确
3. 如果跨域问题，后端需要启用CORS

### Q: 上传视频后无反应？
A:
1. 检查浏览器控制台是否有错误信息
2. 确认视频文件格式正确
3. 检查视频文件大小是否超过500MB

### Q: 转换很慢？
A:
1. 减少`max_frames`数量
2. 增加`keyframe_interval`间隔
3. 降低`frame_quality`质量
4. 检查服务器资源是否足够

### Q: PDF下载后无法打开？
A:
1. 检查转换是否完成（显示已完成状态）
2. 尝试用不同的PDF阅读器打开
3. 检查浏览器是否阻止了下载

## 技术细节

### 前端技术栈

- **Vue 3** - 框架
- **TypeScript** - 类型安全
- **CSS3** - 样式（Scoped CSS）
- **Fetch API** - HTTP请求

### 文件结构

```
smallimg/
├── src/
│   ├── components/
│   │   ├── VideoUploader.vue      # 新增：视频转换组件
│   │   ├── ImageUploader.vue      # 图片上传
│   │   ├── PdfUploader.vue        # PDF上传
│   │   └── ...
│   ├── App.vue                    # 修改：添加视频标签页
│   ├── main.js
│   └── ...
├── index.html
├── vite.config.js
├── package.json
└── VIDEO_INTEGRATION.md            # 本文件
```

### 请求流程

```
1. 用户选择视频文件
2. 前端验证文件类型和大小
3. 构建FormData（文件 + 转换选项）
4. 发送POST请求到 /api/v1/convert
5. 监听上传进度
6. 接收转换结果
7. 显示进度和结果
8. 提供下载链接
```

## 测试建议

### 测试场景

1. **基本转换**
   - 上传一个小MP4文件
   - 转换为Markdown
   - 验证输出内容

2. **大文件处理**
   - 上传>100MB的视频
   - 观察进度显示
   - 验证内存使用

3. **不同格式**
   - 分别测试MP4、AVI、MOV等格式
   - 验证格式检测

4. **转换选项**
   - 测试不同的关键帧间隔
   - 测试最大帧数限制
   - 测试帧质量差异

5. **PDF输出**
   - 转换为PDF格式
   - 验证PDF可以正常打开
   - 检查排版和样式

6. **批量转换**
   - 同时上传多个视频
   - 验证队列处理

## 性能优化建议

### 前端优化

- 使用lazy loading加载组件
- 实现虚拟滚动处理大量转换记录
- 压缩JavaScript和CSS

### 后端优化

- 实施任务队列（如Celery）
- 使用缓存减少重复计算
- 实现流式处理大文件

## 后续改进

### 计划中的功能

- [ ] 转换历史记录保存
- [ ] 本地文件预览
- [ ] 转换模板快速配置
- [ ] 批量转换队列管理
- [ ] 结果分享功能
- [ ] 暗色主题支持

### 可扩展性

- 易于添加新的文件格式转换
- 可重用的UI组件架构
- 模块化的业务逻辑

## 支持

如有问题或需要帮助，请：

1. 检查控制台错误信息
2. 查看后端日志
3. 参考文档中的FAQ部分
4. 提交Issue报告

## 更新日志

### v1.0.0 (2025-12-07)

- ✨ 新增视频转换功能集成
- ✨ 新增VideoUploader组件
- 🎨 更新App.vue添加视频标签页
- 📝 完整的使用文档

---

**祝你使用愉快！🚀**

